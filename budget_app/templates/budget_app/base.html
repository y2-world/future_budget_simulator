<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{% block title %}å®¶è¨ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Toastify CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">

    <style>
        /* ãƒˆãƒ¼ã‚¹ãƒˆã®é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«èª¿æ•´ */
        .toastify-close {
            opacity: 0.8;
            font-size: 18px !important;
            font-weight: 300 !important;
            line-height: 1 !important;
        }
        .toastify-close:hover {
            opacity: 1;
        }
        /* é–‰ã˜ã‚‹ã‚¢ã‚¤ã‚³ãƒ³ã‚’åˆ¥ã®ã‚‚ã®ã«å¤‰æ›´ */
        .toastify-close::before {
            content: "âœ•" !important;
            font-size: 20px;
            display: inline-block;
        }
        .toastify-close {
            text-indent: -9999px;
            position: relative;
        }
        .toastify-close::before {
            text-indent: 0;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen">
    <nav class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-xl sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3">
            <div class="flex justify-between items-center">
                <h1 class="text-xl md:text-2xl font-bold">
                    <a href="{% url 'budget_app:index' %}" class="hover:opacity-90 transition flex items-center">
                        <span class="bg-white text-blue-600 rounded-lg px-2 py-1 mr-2 text-sm md:text-base">ğŸ’°</span>
                        å®¶è¨ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼
                    </a>
                </h1>

                <!-- ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
                <div class="hidden md:flex space-x-6">
                    <a href="{% url 'budget_app:index' %}" class="hover:bg-white/10 px-3 py-2 rounded-lg transition">æœˆæ¬¡è¨ˆç”»</a>
                    <a href="{% url 'budget_app:past_transactions' %}" class="hover:bg-white/10 px-3 py-2 rounded-lg transition">éå»ã®æ˜ç´°</a>
                    <a href="{% url 'budget_app:credit_estimates' %}" class="hover:bg-white/10 px-3 py-2 rounded-lg transition">ã‚¯ãƒ¬ã‚«è¦‹ç©</a>
                    <a href="{% url 'budget_app:credit_defaults' %}" class="hover:bg-white/10 px-3 py-2 rounded-lg transition">å®šæœŸé …ç›®</a>
                    <a href="{% url 'budget_app:salary_list' %}" class="hover:bg-white/10 px-3 py-2 rounded-lg transition">çµ¦ä¸ä¸€è¦§</a>
                    <a href="{% url 'budget_app:config' %}" class="hover:bg-white/10 px-3 py-2 rounded-lg transition">è¨­å®š</a>
                </div>

                <!-- ãƒ¢ãƒã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³ -->
                <button id="mobile-menu-button" class="md:hidden p-2 rounded-lg hover:bg-white/10 transition">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>

            <!-- ãƒ¢ãƒã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
            <div id="mobile-menu" class="hidden md:hidden mt-4 pb-2 space-y-2">
                <a href="{% url 'budget_app:index' %}" class="block hover:bg-white/10 px-4 py-2 rounded-lg transition">æœˆæ¬¡è¨ˆç”»</a>
                <a href="{% url 'budget_app:past_transactions' %}" class="block hover:bg-white/10 px-4 py-2 rounded-lg transition">éå»ã®æ˜ç´°</a>
                <a href="{% url 'budget_app:credit_estimates' %}" class="block hover:bg-white/10 px-4 py-2 rounded-lg transition">ã‚¯ãƒ¬ã‚«è¦‹ç©</a>
                <a href="{% url 'budget_app:credit_defaults' %}" class="block hover:bg-white/10 px-4 py-2 rounded-lg transition">å®šæœŸé …ç›®</a>
                <a href="{% url 'budget_app:salary_list' %}" class="block hover:bg-white/10 px-4 py-2 rounded-lg transition">çµ¦ä¸ä¸€è¦§</a>
                <a href="{% url 'budget_app:config' %}" class="block hover:bg-white/10 px-4 py-2 rounded-lg transition">è¨­å®š</a>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-4 py-8">
        {% block content %}{% endblock %}
    </main>

    <footer class="bg-gradient-to-r from-gray-800 to-gray-900 text-white py-6 mt-12">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <p class="text-sm text-gray-400">&copy; 2025 å®¶è¨ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</p>
                <p class="text-xs text-gray-500 mt-2 md:mt-0">æœªæ¥ã®å®¶è¨ˆã‚’è³¢ãç®¡ç†</p>
            </div>
        </div>
    </footer>

    <!-- Toastify JS -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <!-- å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•° -->
    {% load static %}
    <script type="text/javascript" src="{% static 'budget_app/js/common.js' %}?v={% now "U" %}"></script>

    <script>
        // ========================================
        // ãƒ¢ãƒã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒˆã‚°ãƒ«
        // ========================================
        document.getElementById('mobile-menu-button')?.addEventListener('click', function() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        });

        // ========================================
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®ã‚¢ãƒ³ã‚«ãƒ¼ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å‡¦ç†
        // ========================================
        window.addEventListener('load', function() {
            const scrollToAnchor = sessionStorage.getItem('scrollToAnchor');
            if (scrollToAnchor) {
                // sessionStorageã‚’ã‚¯ãƒªã‚¢
                sessionStorage.removeItem('scrollToAnchor');

                // å°‘ã—é…å»¶ã•ã›ã¦è¦ç´ ãŒç¢ºå®Ÿã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ã®ã‚’å¾…ã¤
                setTimeout(function() {
                    const targetElement = document.querySelector(scrollToAnchor);
                    if (targetElement) {
                        // ãƒ˜ãƒƒãƒ€ãƒ¼ã®é«˜ã•ã‚’å–å¾—
                        const header = document.querySelector('nav');
                        const headerHeight = header ? header.offsetHeight : 0;

                        // è¦ç´ ã®ä½ç½®ã‚’å–å¾—ã—ã¦ãƒ˜ãƒƒãƒ€ãƒ¼åˆ†ã‚’å¼•ã
                        const elementPosition = targetElement.getBoundingClientRect().top;
                        const offsetPosition = elementPosition + window.pageYOffset - headerHeight - 20; // 20pxã®ä½™ç™½ã‚’è¿½åŠ 

                        // ã‚¹ãƒ ãƒ¼ã‚ºã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
                        window.scrollTo({
                            top: offsetPosition,
                            behavior: 'smooth'
                        });
                    }
                }, 100); // 100msé…å»¶
            }
        });
    </script>
</body>
</html>
